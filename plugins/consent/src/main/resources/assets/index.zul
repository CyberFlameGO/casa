<?page language="xhtml"?>
<?init class="org.zkoss.zk.ui.util.Composition" template="/general.zul"?>
<?link rel="stylesheet" type="text/css" href="/pl/consent-plugin/css/consent.css"?>
<zk:zk xmlns:z="http://www.zkoss.org/2005/zul" xmlns:h="xhtml" xmlns:zk="zk" xmlns="native">

    <h:title self="@define(title)">${zkService.appName} - ${labels.consent.title}</h:title>

    <z:div if="${empty pageScope.error}" viewModel="@('org.gluu.casa.plugins.consent.ConsentVM')"
           self="@define(maincontent)">

        <div class="${css['sectionsWrapper']} pt3">
            <section class="${css.section}">
                <div class="${css.panel}">
                    <h2 class="f4 dark-blue2">${labels.consent.title}</h2>
                    <z:div  children="@load(vm.consentResponse.consentList)">
                        <zk:template name="children">
                            <div class="${css.panel} flex justify-between ">
                                <div class="items-start">
                                    <div class="${css.panel}">
                                        <p>${labels.consent.access.provider}</p>
                                        <z:label sclass="dark-blue2 uppercaseStyle" value="@load(each.provider)" />
                                    </div>
                                    <div class="${css.panel}">
                                        <p>${labels.consent.access.status}</p>
                                        <zk:zk if="${each.status == 'REVOKED' || each.status == 'REJECTED'}">
                                            <z:label sclass="dark-blue2 uppercaseStyle textRed" value="@load(each.status)" />
                                        </zk:zk>
                                        <zk:zk if="${each.status == 'AUTHORIZED' || each.status == 'ACTIVE'}">
                                            <z:label sclass="dark-blue2 uppercaseStyle textGreen" value="@load(each.status)" />
                                        </zk:zk>
                                    </div>
                                    <div class="${css.panel}">
                                        <p>${labels.consent.access.createdDate}</p>
                                        <z:label sclass="dark-blue2 uppercaseStyle" value="@load(each.createdDate)" />
                                    </div>
                                    <div class="${css.panel}">
                                        <p>${labels.consent.access.updatedDate}</p>
                                        <z:label sclass="dark-blue2 uppercaseStyle" value="@load(each.updatedDate)" />
                                    </div>
                                    <div class="${css.panel}">
                                        <p>${labels.consent.access.expirationDate}</p>
                                        <zk:zk if="${not empty each.expirationDate}">
                                        <z:label sclass="dark-blue2 uppercaseStyle" value="@load(each.expirationDate)" />
                                        </zk:zk>
                                        <zk:zk if="${empty each.expirationDate}">
                                            <z:label sclass="dark-blue2 uppercaseStyle" value="-" />
                                        </zk:zk>
                                    </div>
                                    <div class="${css.panel}">
                                        <p>${labels.consent.access.softCode}</p>
                                        <z:label sclass="dark-blue2" value="@load(each.consentId)" />
                                    </div>
                                    <div class="${css.panel}">
                                    <z:button label="${labels.consent.button_label}" class="btnBordered" onClick="@('loadOrgName')" />
                                    </div>
                                </div>
                            </div>
                        </zk:template>
                    </z:div>
                </div>

                <z:div class="${css.panel} w-100 tc" visible="@load(not empty vm.organizationName)">
                    <z:label class="i f4" value="@load(c:cat3(c:l('consent.org_name'), ' ', c:toUpperCase(vm.organizationName)))" />
                </z:div>
            </section>
        </div>
    </z:div>

</zk:zk>
